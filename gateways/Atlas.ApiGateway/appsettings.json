{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Yarp": "Information"
    }
  },
  "ConnectionStrings": {
    "Redis": "redis:6379"
  },
  "ApiGateway": {
    "Authentication": {
      "Authority": "https://login.microsoftonline.com/<tenant-id>/v2.0",
      "Audience": "api://atlas-public",
      "RequireHttpsMetadata": true
    },
    "RateLimiting": {
      "PermitPerMinute": 120,
      "Redis": "redis:6379"
    },
    "Cors": {
      "AllowedOrigins": [
        "https://localhost:3000",
        "https://atlasbank.com",
        "https://app.atlasbank.com"
      ]
    },
    "Security": {
      "EnableHttpsRedirection": true,
      "EnableHsts": true,
      "HstsMaxAgeDays": 365
    }
  },
  "ReverseProxy": {
    "Routes": {
      "ledger": { 
        "ClusterId": "ledger", 
        "Match": { "Path": "/ledger/{**catchall}" }
      },
      "payments": { 
        "ClusterId": "payments", 
        "Match": { "Path": "/payments/{**catchall}" }
      },
      "aml": { 
        "ClusterId": "kycaml", 
        "Match": { "Path": "/aml/{**catchall}" }
      },
      "loans": { 
        "ClusterId": "loans", 
        "Match": { "Path": "/loans/{**catchall}" }
      }
    },
    "Clusters": {
      "ledger": { 
        "Destinations": { 
          "d1": { "Address": "http://ledgerapi:5181" } 
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      },
      "payments": { 
        "Destinations": { 
          "d1": { "Address": "http://paymentsapi:5191" } 
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      },
      "kycaml": { 
        "Destinations": { 
          "d1": { "Address": "http://kycamlapi:5201" } 
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      },
      "loans": { 
        "Destinations": { 
          "d1": { "Address": "http://loansapi:5211" } 
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/health"
          }
        }
      }
    }
  }
}
